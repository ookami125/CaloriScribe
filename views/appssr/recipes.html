<div class="ambient"></div>
{{{header}}}
<div class="ui-fill ui-scroll">
  <main class="page">
    <section class="panel" id="recipe-editor-panel">
      <div class="panel-header">
        <div>
          <h1>Recipe builder</h1>
          <p>Combine ingredients and check macros before you log.</p>
        </div>
      </div>
      <div class="stacked-section">
        <div class="panel-header">
          <div>
            <h2>Daily overview</h2>
            <p>Today's totals with one serving of this recipe.</p>
          </div>
        </div>
        <div class="hero-grid">
          {{{caloriesPanel}}}
          {{{macroSplitPanel}}}
        </div>
      </div>
      <div class="panel-body split">
        <form id="recipe-form" class="stacked-card">
          <h3 id="recipe-form-title">Create recipe</h3>
          <div class="grid two">
            <label>
              Recipe name
              <input type="text" name="name" required>
            </label>
            <label>
              Servings
              <input type="number" name="servings" min="1" value="1">
            </label>
          </div>
          <label>
            Notes
            <textarea name="notes" rows="3"></textarea>
          </label>
          <div class="recipe-items" id="recipe-items"></div>
          <div class="form-actions">
            <button class="ghost" id="add-recipe-item" type="button">Find ingredient</button>
            <button class="ghost" id="recipe-cancel" type="button" hidden>Cancel edit</button>
          </div>
          <button class="primary" id="recipe-submit" type="submit">Create recipe</button>
          <p class="form-status" id="recipe-status"></p>
        </form>
        <div class="recipe-side">
          <div class="panel-tabs" role="tablist" aria-label="Recipe panels">
            <button class="tab-button is-active" id="recipe-panel-recipes" type="button" data-recipe-panel="recipes">Recipes</button>
            <button class="tab-button" id="recipe-panel-ingredients" type="button" data-recipe-panel="ingredients">Ingredients</button>
          </div>
          <div id="recipe-list-panel">
            <div class="list scroll" id="recipe-list"></div>
          </div>
          <div id="recipe-ingredients-panel" hidden>
            <div class="stacked-card">
              <h3>Ingredient library</h3>
              <label>
                Search name or barcode
                <div class="field-row">
                  <input id="recipe-ingredient-search" type="search" name="recipe-ingredient-search" placeholder="e.g. oats or 0123456789">
                  <button class="ghost" type="button" data-scan-trigger data-scan-target="recipe-ingredient">Scan barcode</button>
                </div>
              </label>
            </div>
            <div class="list scroll" id="recipe-ingredient-list"></div>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>

<div class="modal" id="scan-modal" aria-hidden="true">
  <div class="modal-card">
    <div class="modal-header">
      <h3>Scan barcode</h3>
      <div class="modal-actions">
        <button class="icon-button" id="scan-upload-open" type="button" aria-label="Upload barcode image" title="Upload barcode image">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M12 16a1 1 0 0 1-1-1V7.41l-2.3 2.3a1 1 0 1 1-1.4-1.42l4.01-4.01a1 1 0 0 1 1.4 0l4.01 4.01a1 1 0 0 1-1.4 1.42L13 7.41V15a1 1 0 0 1-1 1z" fill="currentColor"/>
            <path d="M4 18a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2a1 1 0 1 0-2 0v2H6v-2a1 1 0 1 0-2 0v2z" fill="currentColor"/>
          </svg>
        </button>
        <button class="ghost" id="close-scan" type="button">Close</button>
      </div>
    </div>
    <div class="scan-area" id="scan-area">
      <video id="scan-video" autoplay playsinline></video>
      <div class="scan-target"></div>
    </div>
    <p class="form-status" id="scan-status"></p>
  </div>
</div>

<div class="modal" id="scan-upload-modal" aria-hidden="true">
  <div class="modal-card">
    <div class="modal-header">
      <h3>Upload barcode</h3>
      <div class="modal-actions">
        <button class="icon-button" id="scan-upload-back" type="button" aria-label="Back to camera" title="Back to camera">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M9 7l1.4-2.1A2 2 0 0 1 12.1 4h1.8a2 2 0 0 1 1.7.9L17 7h1a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-6a3 3 0 0 1 3-3h3z" fill="currentColor"/>
            <path d="M12 17a4 4 0 1 0 0-8 4 4 0 0 0 0 8z" fill="currentColor"/>
          </svg>
        </button>
        <button class="ghost" id="scan-upload-close" type="button">Close</button>
      </div>
    </div>
    <label class="file-input">
      Upload barcode image
      <input id="scan-image-input" type="file" accept="image/*">
    </label>
    <div class="scan-image-preview" id="scan-image-preview" hidden>
      <div class="scan-image-stage" id="scan-image-stage">
        <img id="scan-image" alt="Barcode preview">
        <div class="scan-target"></div>
      </div>
      <div class="scan-image-controls">
        <label class="field">
          Zoom
          <input id="scan-image-zoom" type="range" min="1" max="4" step="0.01" value="1">
        </label>
        <div class="scan-image-actions">
          <button class="ghost" id="scan-image-reset" type="button">Reset</button>
          <button class="primary" id="scan-image-scan" type="button">Scan image</button>
        </div>
      </div>
    </div>
    <p class="form-status" id="scan-upload-status"></p>
  </div>
</div>

{{{cardTemplates}}}
{{{confirmModal}}}

<script src="https://unpkg.com/@zxing/library@0.21.2/umd/index.min.js"></script>
<script src="/app.js"></script>
